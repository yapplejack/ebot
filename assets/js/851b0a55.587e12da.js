"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[8088],{5458:(e,t,l)=>{l.r(t),l.d(t,{default:()=>r});var a=l(7294),s=(l(2084),l(3162));const r=function(){const[e,t]=(0,a.useState)([]),[r,o]=(0,a.useState)([]),[i,n]=(0,a.useState)([]),[h,c]=(0,a.useState)(""),[p,g]=(0,a.useState)(0),[f,m]=(0,a.useState)(!1),[d,w]=(0,a.useState)({}),[y,u]=(0,a.useState)([]),[v,x]=(0,a.useState)([]),[b,k]=(0,a.useState)([]),[S,O]=(0,a.useState)([]),[A,P]=(0,a.useState)([]),E=l(5733)();(0,a.useEffect)((()=>{if(""!=i&&""!=e&&p==e.length-2&&1==f&&(console.log("called"),L()),0!=p&&p!=e.length-2)throw new Error("The number of images supplied does not match the number of images found in the google doc. Please make sure all positioned images are 'move with text' and not 'fix position to page'.")}),[i,e,p,f]);const T=(t,l)=>{let a="",s=r[t].split(/<div style={{overflow/);for(let r=0;r<s.length;r++)if(s[r].match('.png"')){v[l]=e[parseInt(s[r].split("images/")[1].split('"')[0].split("image")[1].split(".png")[0])],b[l]=s[r].split("images/")[1].split('"')[0].split("image")[1],x(v),k(b);let t=s[r].split("<img")[1].split('.png" ')[1],o=i[l].split("default}")[0];a+="<div style={{overflow"+s[r].split("<img")[0]+o+"default} "+t.split("}}")[0]+', maxWidth: "none"}}'+t.split("}}")[1],l+=1}else if(s[r].match('.jpg"')){v[l]=e[parseInt(s[r].split("images/")[1].split('"')[0].split("image")[1].split(".jpg")[0])],b[l]=s[r].split("images/")[1].split('"')[0].split("image")[1],x(v),k(b);let t=s[r].split("<img")[1].split('.jpg" ')[1],o=i[l].split("default}")[0];a+="<div style={{overflow"+s[r].split("<img")[0]+o+"default} "+t.split("}}")[0]+', maxWidth: "none"}}'+t.split("}}")[1],l+=1}else a+=s[r];return a},$=(e,t)=>{let l=e.split(/<div style={{overflow/);e="";for(let a=0;a<l.length;a++)if(l[a].match(/^: 'hidden'/))i[t].match(/left=\"-?(\d+)/i)?parseFloat(i[t].match(/left=\"-?(\d+)/i)[1])>375?e+="<div style={{overflow: 'hidden', float: 'right', "+l[a].split(": 'hidden', ")[1].split(/overflow/)[0]+"float: 'right', overflow: 'hidden', "+l[a].split(/overflow: 'hidden', /)[1]:e+="\n\n<div style={{overflow: 'hidden', float: 'left', "+l[a].split(": 'hidden', ")[1].split(/overflow/)[0]+"float: 'left', overflow: 'hidden', "+l[a].split(/overflow: 'hidden', /)[1]+"\n\n":e+="<div style={{overflow"+l[a],t+=1;else{if(l[a].match(/: 'hidden'/))throw new Error("I thought that overflow hidden would only exist with images or perhaps the image was not wrapped with a span. Please let Jack know you encounter this error.");e+=l[a]}return[e,t]},L=()=>{let e=0;for(let t=0;t<r.length;t++){if(r[t].match(/<div style={{overflow:/)){let l=T(t,e);[A[t],e]=$(l,e)}else A[t]=r[t];P(A)}console.log(A),console.log(b),(()=>{let e="";for(let t=0;t<A.length;t++)e+=A[t]+"\n\n";console.log(e)})(),(()=>{if(v.length>0){console.log(v);for(let e=0;e<v.length;e++)console.log(b[e]),b[e].match(/.jpg/)?E.file("image_"+e+".jpg",v[e]):E.file("image_"+e+".png",v[e]);E.generateAsync({type:"blob"}).then((e=>{(0,s.saveAs)(e,"images.zip")}))}})()},J=async e=>{let l=await e[0].text();t(e);let a=await e[e.length-1].text();!function(e){let t=e.split("table th")[1].match(/(?<=\}).*?(?=\})/g),l=[];for(let s=0;s<t.length;s++){l[s]=t[s].split("{")[0]+" ";let e=l[s].length;t[s].match(/text-align:center/)&&(l[s]+="textAlign: 'center'"),t[s].match(/color:/),t[s].match(/font-weight/)&&!t[s].match(/font-weight:400/)&&(l[s].length!=e&&(l[s]+=", "),l[s]+='fontWeight: "'+t[s].match(/(?<=font-weight:).*?(?=;|$|\})/)+'"'),t[s].match(/background-color:/)&&!t[s].match(/background-color:#ffffff/)&&(l[s].length!=e&&(l[s]+=", "),l[s]+='backgroundColor: "#'+t[s].match(/(?<=background-color:#).*?(?=;|$|\})/)+'"'),t[s].match(/font-size/)&&!t[s].match(/font-size:11/)&&(l[s].length!=e&&(l[s]+=", "),l[s]+='fontSize: "'+t[s].match(/(?<=font-size:).*?(?=;|$|\})/)+'"'),t[s].match(/text-decoration/)&&!t[s].match(/text-decoration:none/)&&(l[s].length!=e&&(l[s]+=", "),l[s]+='textDecoration: "'+t[s].match(/(?<=text-decoration:).*?(?=;|$|\})/)+'"')}let a={h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,ol:!0,ul:!0,li:!0,a:!0};for(let s=0;s<l.length;s++)l[s].match(/\.?\w\d*?\s$/)||a.hasOwnProperty(l[s].match(/\S+/)[0])||(l[s].match(/\S+/)[0].match(/^\.\S+/)?d[l[s].match(/(?<=^\.)\S+/)[0]]=l[s].match(/(?<=\S+\s).*/)[0]:d[l[s].match(/\S+/)[0]]=l[s].match(/(?<=\S+\s).*/)[0]);w(d),console.log(d)}(a.split("/head>")[0]),(async e=>{let t=0,l=0,a=0,s=[],i=(e=e.split("</head>")[1].match(/(?<=>).*/)[0]).match(/(?<=<).*?(?=>|\s)|<^\S*?(?=>|\s)/)[0],n=e.indexOf(i);for(s[t]=e.slice(0,n+1+i.length),e=e.slice(n+1+i.length);"</html>"!=e;){"hr"==i&&(s[t]+=e.slice(0,e.search(">")+1),i=(e=e.slice(e.search(">")+1)).match(/(?<=<).*?(?=>|\s)|<^\S*?(?=>|\s)/)[0],n=e.indexOf(i),t+=1,"<"==e.slice(n+1+i.length)[0]?s[t]=i+">":s[t]=i+" ",s[t]=e.slice(0,n+1+i.length),e=e.slice(n+1+i.length));let l=new RegExp(`(?<=</)${i}(?=>)`),r=new RegExp(`(?<=<)${i}(?=>| )`);if(e.search(l)>e.search(r)&&-1!=e.search(r))throw new Error("OwO what is this? I was not able to find it in my test cases but you found the something that breaks my code. Please Jack know you 'found nested HTML tags on a doc import'.");if(-1==e.search(l))throw new Error("HMTL not correctly parsed, please contact Jack and send them the HTML with this error message :)");s[t]+=e.slice(0,e.search(l)+1+i.length),i=(e=e.slice(e.search(l)+1+i.length)).match(/(?<=<).*?(?=>|\s)|<^\S*?(?=>|\s)/)[0],n=e.indexOf(i),t+=1,"<"==e.slice(n+1+i.length)[0]?s[t]=i+">":s[t]=i+" ",s[t]=e.slice(0,n+1+i.length),e=e.slice(n+1+i.length),a+=1}console.log(JSON.parse(JSON.stringify(s)));let h={h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,ol:!0,ul:!0,li:!0,a:!0,hr:!0};t=0,l=0;let c=!1;for(let p=0;p<s.length-1;p++){let e=s[p].match(/(?<=<).*?(?=>|\s)|<^\S*?(?=>|\s)/),a="",i="",n={},g=!1,f=!1,m=!1,w=!1;if(c=!1,r[t]="",s[p].match(/^<[^>]*?\sclass[^>]*?>/)&&!h.hasOwnProperty(e)){let e=s[p].match(/(?<=class=").*?(?=")/)[0].split(" ");for(let l=0;l<e.length;l++)d.hasOwnProperty(e[l])&&0==g?(r[t]="<div style={{ "+d[e[l]],a="div",g=!0,f=!0):d.hasOwnProperty(e[l])&&1==g&&(r[t]+=", "+d[e[l]]);1==g&&(r[t]+="}}>")}if(s[p].match(/^<[^>]*?\sstyle[^>]*?>/)&&"hr"!=e){g=!0,m=!0;const e=/-\webkit\-transform: 'rotate\(\d{1}\.\d{2}rad\) translateZ\(\d{1}px\)',/;let a=s[p].match(/<\/span>/)[0].split("span style")[1].replaceAll(";","',").replaceAll(": ",": '").replaceAll("margin-left","marginLeft").replaceAll("margin-top","marginTop").replace(e,"").replaceAll("border: 0.00px solid #000000,","").replace('="',"").replaceAll(/, -webkit-transform: 'rotate\(-?\d+\.\d+rad\) translateZ\(\d\.?\d*?px\)'[,;]/g,"").replace('px,"',"px").replace(">","}}>").replace('">',"'}}>").replace("style=","style={{ ").replace("px',\"","px'").replace('" title="\'',"").replace('"width',"width");a="<div style={{overflow: 'hidden', display: 'inline-block', margin: '0.00px 0.00px'}}><span style={{"+a+"</img></span></div>",r[t]=a,l+=1,t+=1,r[t]="",w=!0}h.hasOwnProperty(e)&&("hr"==e?(r[t]="<div style={{pageBreakAfter: 'always'}}></div>",w=!0,g=!0):(r[t]="<"+e+">",f=!0,g=!0)),0==g&&(n[e]=!0),s[p]=s[p].replace(/<(?<=<).*?>/,"");let y=0;for(;0==w&&y<5e3;){if(g=!1,s[p].match(/^<[^/]/)){let a=s[p].match(/(?<=<).*?(?=>|\s)|<^\S*?(?=>|\s)/);if(s[p].match(/^<[^>]*?\sclass[^>]*?>/)&&!h.hasOwnProperty(a)&&"h1"!=e){let e=s[p].match(/(?<=class=").*?(?=")/)[0].split(" ");for(let l=0;l<e.length;l++)d.hasOwnProperty(e[l])&&0==f?(r[t]="<span style={{ "+d[e[l]],g=!0,f=!0):d.hasOwnProperty(e[l])&&1==g?r[t]+=", "+d[e[l]]:d.hasOwnProperty(e[l])&&(r[t]+="<span style={{ "+d[e[l]],g=!0);1==g&&("span"==a&&(n[a]=!1),r[t]+="}}>"),s[p]=s[p].replace(/<(?<=<).*?>/,"")}else if(s[p].match(/^<[^>]*?\sstyle[^>]*?>/)&&"hr"!=a){m=!0,g=!0;const e=/-\webkit\-transform: 'rotate\(\d{1}\.\d{2}rad\) translateZ\(\d{1}px\)',/;let a=s[p].match(".*?(?=</)")[0].split("span style")[1].replaceAll(";","',").replaceAll(": ",": '").replaceAll("margin-left","marginLeft").replaceAll("margin-top","marginTop").replace(e,"").replaceAll("border: 0.00px solid #000000,","").replace('="',"").replaceAll(/, -webkit-transform: 'rotate\(-?\d+\.\d+rad\) translateZ\(\d\.?\d*?px\)'[,;]/g,"").replace('px,"',"px").replace(">","}}>").replace('">',"'}}>").replace("style=","style={{ ").replace("px',\"","px'").replace('" title="\'',"").replace('"width',"width");a="<div style={{overflow: 'hidden', display: 'inline-block', margin: '0.00px 0.00px'}}><span style={{"+a+"</img></span></div>",s[p]=s[p].replace(/<(?<=<).*?>/,""),s[p]=s[p].replace(/<(?<=<).*?>/,""),s[p]=s[p].replace(/^<\/.*?>/,""),r[t]+=a,l+=1}else h.hasOwnProperty(a)?(g=!0,"hr"==a?(s[p]=s[p].replace(/<(?<=<).*?>/,""),g=!0,c=!0,console.warn("Please investigate pagebreaks, there may a positioned image attached to one, ask Jack how to fix.\n")):"a"==a?(r[t]+=s[p].match(/<a.*?<\/a>/),s[p]=s[p].replace(/<a.*?<\/a>/,"")):(r[t]+="<"+a+">",s[p]=s[p].replace(/<(?<=<).*?>/,""))):s[p]=s[p].replace(/<(?<=<).*?>/,"");0==g&&(n[a]=!0)}else if(s[p].match(/^<\//)){let l=new RegExp(`(?<=^</)${e}(?=>)`);s[p].match(l)?(w=!0,n.hasOwnProperty(e)&&1==n[e]||(r[t]+=""!=a?"</"+a+">":"</"+e+">")):n.hasOwnProperty(s[p].match(/(?<=^<\/).*?(?=>)/))&&1==n[s[p].match(/(?<=^<\/).*?(?=>)/)]?(n[i]=!1,s[p]=s[p].replace(/^<\/.*?>/,"")):(r[t]+=s[p].match(/^<\/.*?>/),s[p]=s[p].replace(/^<\/.*?>/,""))}else f=!0,r[t]+=s[p].match(/.*?(?=<\/)/),s[p]=s[p].replace(/.*?(?=<\/)/,"");y+=1}if(1==w&&(t+=1,1==c&&(console.warn("broke page"),r[t]="<div style={{pageBreakAfter: 'always'}}></div>",t+=1,c=!1)),0==w)throw new Error("Unable to parse HTML at top level item: "+p);o(r)}console.log(r)})(a),function(e){e=e.split("\n").filter((function(e){return e}));let t=0;for(;t<e.length&&!e[t].match("<img src=");)t+=1;let l=[];for(;t<e.length;)l.push(e[t]),t+=1;g(l.length),n(l)}(l),function(){console.log("in");let e=0,t=[],l=0;for(let a=0;a<r.length;a++)if(""==r[a])e+=1;else if(r[a].match(/(?!.*img)(?!.*pageBreakAfter)(?!.*>[^<]+?<)^<.*?></))e+=1;else{if(e>0){let a="<p>";for(let t=0;t<e;t++)a+="<br /> ";a+="</p>",e=0,t[l]=a,l+=1}t[l]=r[a],l+=1}for(let a=0;a<t.length;a++)r[a]=t[a];r.length=t.length,o(r),console.log(r)}(),m(!0),console.log(p),console.log("here")};return a.createElement("div",{className:"Importer"},a.createElement("center",null,a.createElement("input",{multiple:!0,type:"file",onChange:e=>{(async e=>{if(console.log("in"),"md"!=e[0].name.split(".").pop())throw new Error("Please attach your markdown file as the first file (rename it so that it comes first in the file directory");if("html"!=e[e.length-1].name.split(".").pop())throw new Error("Please have your HTML file last (rename it to be last in the file directory)");await J(e)})(e.target.files)}})))}}}]);